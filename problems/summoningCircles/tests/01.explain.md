And here is another walkthrough for Sample 1 where **P=15**, **K=2**, **M=4**, **Q=2**.
<pre>[ 1] S= 0 :   0 ( 1)
[ 2] S= 0 :   0   1 ( 2)
[ 3] S= 0 :   0   1 ( 3)  2
[ 4] S= 4 : ( 1)  3   2
[ 5] S= 4 :   1   3   2 ( 5)
[ 6] S= 4 :   1   3 ( 6)  2   5
[ 7] S= 4 :   1   3   6   2   5 ( 7)
[ 8] S=14 :   1   3   6 ( 5)  7
[ 9] S=14 :   1 ( 9)  3   6   5   7
[10] S=14 :   1   9   3   6 (10)  5   7
[11] S=14 :   1   9   3   6  10   5   7 (11)
[12] S=31 :   1   9   3   6  10 ( 7) 11
[13] S=31 :   1 (13)  9   3   6  10   7  11
[14] S=31 :   1  13   9   3 (14)  6  10   7  11</pre>
